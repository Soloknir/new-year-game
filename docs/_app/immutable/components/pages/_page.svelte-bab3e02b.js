var wt=Object.defineProperty;var yt=(a,t,e)=>t in a?wt(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var n=(a,t,e)=>(yt(a,typeof t!="symbol"?t+"":t,e),e);import{S as T,i as P,s as I,k as y,l as x,m as B,h as v,n as u,b as S,B as L,I as xt,J as H,a as k,c as R,K as V,L as Q,D as C,M as lt,o as K,N as U,q as J,r as W,p as j,f as D,g as ct,t as A,d as dt,v as tt,w as F,x as gt,y as G,z as N,O as bt}from"../../chunks/index-5038dfa0.js";function et(a,t,e){const i=a.slice();return i[12]=t[e].flip,i[13]=t[e].name,i[14]=t[e].alt,i[16]=e,i}function it(a){let t,e,i,s,r,o,h,l,d,c,m;function _(){return a[2](a[16])}return{c(){t=y("div"),e=y("img"),r=k(),o=y("img"),l=k(),this.h()},l(M){t=x(M,"DIV",{class:!0,"data-name":!0});var w=B(t);e=x(w,"IMG",{class:!0,src:!0,alt:!0}),r=R(w),o=x(w,"IMG",{class:!0,src:!0,alt:!0}),l=R(w),w.forEach(v),this.h()},h(){u(e,"class","front-face svelte-pdp5dg"),V(e.src,i="/new-year-game/assets/flip/"+a[13]+".svg")||u(e,"src",i),u(e,"alt",s=a[14]),u(o,"class","back-face svelte-pdp5dg"),V(o.src,h="/new-year-game/assets/flip/js-badge.svg")||u(o,"src",h),u(o,"alt","Memory Card"),u(t,"class","memory-card svelte-pdp5dg"),u(t,"data-name",d=a[13]),Q(t,"flip",a[12])},m(M,w){S(M,t,w),C(t,e),C(t,r),C(t,o),C(t,l),c||(m=lt(t,"click",_),c=!0)},p(M,w){a=M,w&1&&!V(e.src,i="/new-year-game/assets/flip/"+a[13]+".svg")&&u(e,"src",i),w&1&&s!==(s=a[14])&&u(e,"alt",s),w&1&&d!==(d=a[13])&&u(t,"data-name",d),w&1&&Q(t,"flip",a[12])},d(M){M&&v(t),c=!1,m()}}}function Ct(a){let t,e=a[0],i=[];for(let s=0;s<e.length;s+=1)i[s]=it(et(a,e,s));return{c(){t=y("div");for(let s=0;s<i.length;s+=1)i[s].c();this.h()},l(s){t=x(s,"DIV",{class:!0});var r=B(t);for(let o=0;o<i.length;o+=1)i[o].l(r);r.forEach(v),this.h()},h(){u(t,"class","memory-game svelte-pdp5dg")},m(s,r){S(s,t,r);for(let o=0;o<i.length;o+=1)i[o].m(t,null)},p(s,[r]){if(r&3){e=s[0];let o;for(o=0;o<e.length;o+=1){const h=et(s,e,o);i[o]?i[o].p(h,r):(i[o]=it(h),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},i:L,o:L,d(s){s&&v(t),xt(i,s)}}}function Mt(a,t,e){const i=H();let s=!1,r=!1,o=null,h=null,l=[{name:"react",alt:"React",flip:!1,order:0},{name:"react",alt:"React",flip:!1,order:0},{name:"angular",alt:"Angular",flip:!1,order:0},{name:"angular",alt:"Angular",flip:!1,order:0},{name:"ember",alt:"Ember",flip:!1,order:0},{name:"ember",alt:"Ember",flip:!1,order:0},{name:"vue",alt:"Vue",flip:!1,order:0},{name:"vue",alt:"Vue",flip:!1,order:0},{name:"aurelia",alt:"Aurelia",flip:!1,order:0},{name:"aurelia",alt:"Aurelia",flip:!1,order:0},{name:"backbone",alt:"Backbone",flip:!1,order:0},{name:"backbone",alt:"Backbone",flip:!1,order:0}];function d(b){if(!r&&o!==b){if(e(0,l[b].flip=!0,l),!s){s=!0,o=b;return}h=b,r=!0,c()}}function c(){o!==null&&h!==null&&(l[o].name===l[h].name?m():_(l[o],l[h]))}function m(){M(),l.some(b=>!b.flip)||i("done")}function _(b,E){setTimeout(()=>{b.flip=!1,E.flip=!1,e(0,l=[...l]),M()},1500)}function M(){s=!1,r=!1,o=null,h=null}return function(){e(0,l=l.map(E=>(E.order=Math.ceil(Math.random()*12),E)).sort((E,pt)=>E.order>pt.order?1:-1))}(),[l,d,b=>d(b)]}class St extends T{constructor(t){super(),P(this,t,Mt,Ct,I,{})}}let z;const _t=new Uint8Array(16);function Lt(){if(!z&&(z=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(_t)}const f=[];for(let a=0;a<256;++a)f.push((a+256).toString(16).slice(1));function Bt(a,t=0){return(f[a[t+0]]+f[a[t+1]]+f[a[t+2]]+f[a[t+3]]+"-"+f[a[t+4]]+f[a[t+5]]+"-"+f[a[t+6]]+f[a[t+7]]+"-"+f[a[t+8]]+f[a[t+9]]+"-"+f[a[t+10]]+f[a[t+11]]+f[a[t+12]]+f[a[t+13]]+f[a[t+14]]+f[a[t+15]]).toLowerCase()}const Et=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),st={randomUUID:Et};function Y(a,t,e){if(st.randomUUID&&!t&&!a)return st.randomUUID();a=a||{};const i=a.random||(a.rng||Lt)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){e=e||0;for(let s=0;s<16;++s)t[e+s]=i[s];return t}return Bt(i)}class ut{constructor(t,e){n(this,"type","");n(this,"id");n(this,"once");n(this,"callback");n(this,"check",t=>!1);this.id=Y(),this.once=t,this.callback=e}}class Dt extends ut{constructor(e,i,s){super(i,s);n(this,"type","collision");n(this,"object");n(this,"check",e=>mt(e,this.object));this.object=e}}class kt extends ut{constructor(e,i,s,r,o){super(r,o);n(this,"type","edge");n(this,"sign");n(this,"axis");n(this,"value");n(this,"check",e=>this.axis==="x"?this.sign==="gather"?e.vCoordinates.x+e.getLeft()>this.value:e.vCoordinates.x+e.getRight()<this.value:this.sign==="gather"?e.vCoordinates.y+e.getBottom()>this.value:e.vCoordinates.y+e.getTop()<this.value);this.sign=e,this.axis=i,this.value=s}}class O{constructor(t,e){n(this,"id");n(this,"vCoordinates");n(this,"vVelocity");n(this,"eventListeners",[]);n(this,"draw",(t,e,i)=>{});n(this,"update",(t,e)=>this.checkEventListeners());n(this,"checkEventListeners",()=>{});n(this,"addEventListener",t=>this.eventListeners.push(t));n(this,"removeEventListener",t=>{const e=this.eventListeners.findIndex(({id:i})=>i===t);e>-1&&this.eventListeners.splice(e,1)});this.id=Y(),this.vCoordinates=t,this.vVelocity=e}}const $=a=>"width"in a&&"height"in a,nt=a=>"radius"in a,Rt=a=>"isColliding"in a,At=a=>"mass"in a,Tt=(a,t)=>!(t.vCoordinates.x>a.width+a.vCoordinates.x||a.vCoordinates.x>t.width+t.vCoordinates.x||t.vCoordinates.y>a.height+a.vCoordinates.y||a.vCoordinates.y>t.height+t.vCoordinates.y),at=(a,t)=>{const e=t.vCoordinates.getCopy(),{width:i,height:s}=a;return e.x=t.vCoordinates.x<a.vCoordinates.x?a.vCoordinates.x:t.vCoordinates.x>a.vCoordinates.x+i?a.vCoordinates.x+i:e.x,e.y=t.vCoordinates.y<a.vCoordinates.y?a.vCoordinates.y:t.vCoordinates.y>a.vCoordinates.y+s?a.vCoordinates.y+s:e.y,t.vCoordinates.getDistance(e)<=t.radius},Pt=(a,t)=>a.vCoordinates.getDistance(t.vCoordinates)<=a.radius+t.radius,mt=(a,t)=>{if(nt(a)){if(nt(t))return Pt(a,t);if($(t))return at(t,a)}return $(a)?$(t)?Tt(a,t):at(a,t):!1};class g{constructor(t=0,e=0){n(this,"x");n(this,"y");n(this,"getCopy",()=>new g(this.x,this.y));n(this,"getCoordsObject",()=>({x:this.x,y:this.y}));n(this,"setByCoordsObject",({x:t,y:e})=>(this.x=t,this.y=e,this));n(this,"ceil",()=>(this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this));n(this,"divByNumber",t=>new g(this.x/t,this.y/t));n(this,"getDifference",({x:t,y:e})=>new g(this.x-t,this.y-e));n(this,"getDistance",({x:t,y:e})=>{const i=this.x-t,s=this.y-e;return Math.sqrt(i*i+s*s)});this.x=t,this.y=e}getViewCoordinates(t){return new g(this.x,t-this.y)}}class Z extends O{constructor(e,i,s){super(e,new g);n(this,"width");n(this,"height");n(this,"textures");n(this,"draw",(e,i,s)=>{const r=this.vCoordinates.getViewCoordinates(i);let o=this.height,h=0;for(;o>0;){let l=this.width,d=0;for(;l>0;)e.drawImage(h===0?this.textures.head:this.textures.body,0,0,Math.min(128,l),Math.min(128,o),128*d+r.x-s.x,128*h+r.y-this.height+s.y,Math.min(128,l),Math.min(128,o)),l-=128,d++;o-=128,h++}});n(this,"getTop",()=>this.height);n(this,"getBottom",()=>0);n(this,"getLeft",()=>0);n(this,"getRight",()=>this.width);this.width=i.width,this.height=i.height,this.textures=s}}class vt extends Z{constructor(e,i,s,r){super(e,s,r);n(this,"vSpawn");n(this,"lastDistance");n(this,"behavior");n(this,"update",e=>{this.vCoordinates.x+=this.vVelocity.x*e,this.vCoordinates.y+=this.vVelocity.y*e;const i=this.behavior.vTarget.getDistance(this.vCoordinates);this.lastDistance<i?this.getMoveEndStrategy():this.lastDistance=i});n(this,"getVelocity",()=>{const e=this.behavior.vTarget.getDifference(this.vCoordinates);return e.x===0||e.y===0?e.x!==0?new g(e.x/this.behavior.duration,0):e.y!==0?new g(0,e.y/this.behavior.duration):new g:e.divByNumber(this.behavior.duration)});n(this,"getMoveEndStrategy",()=>{switch(this.behavior.repeat){case"fromStart":{this.vCoordinates=this.vSpawn.getCopy(),this.lastDistance=this.behavior.vTarget.getDistance(this.vSpawn);return}case"fromEnd":{const e=this.vSpawn.getCopy();this.vSpawn=this.behavior.vTarget.getCopy(),this.behavior.vTarget=e,this.vCoordinates=this.vSpawn.getCopy(),this.vVelocity=this.getVelocity(),this.lastDistance=this.behavior.vTarget.getDistance(this.vSpawn);return}default:this.vVelocity=new g}});if(this.vSpawn=e.getCopy(),this.behavior=i,this.lastDistance=i.vTarget.getDistance(this.vSpawn),this.vVelocity=this.getVelocity(),this.behavior.shift){const o=this.behavior.vTarget.getDifference(this.vCoordinates);this.vCoordinates.x+=this.behavior.shift*o.x,this.vCoordinates.x+=this.behavior.shift*o.y}}}class It{constructor(t,e){n(this,"context");n(this,"vViewCoordinates",new g);n(this,"viewPortWidth");n(this,"viewPortHeight");n(this,"gameObjects",[]);n(this,"overlay",null);n(this,"backgroundImage",null);n(this,"time",0);n(this,"secondsPassed",0);n(this,"oldTimeStamp",0);n(this,"start",()=>window.requestAnimationFrame(this.gameLoop));n(this,"gameLoop",t=>{this.overlay?this.overlay.draw(this.context):(this.secondsPassed=(t-this.oldTimeStamp)/1e3,this.time+=this.secondsPassed,this.oldTimeStamp=t,this.gameObjects.forEach(e=>e.update(Math.min(this.secondsPassed,.1),this.vViewCoordinates)),this.detectPlatformCollision(),this.backgroundImage&&this.context.drawImage(this.backgroundImage,0,0,this.viewPortWidth,this.viewPortHeight),this.gameObjects.forEach(e=>e.draw(this.context,this.viewPortHeight,this.vViewCoordinates)),this.drawFps(Math.round(1/this.secondsPassed))),window.requestAnimationFrame(this.gameLoop)});n(this,"drawFps",t=>{this.context.fillStyle="#fff",this.context.font="20px Arial",this.context.textAlign="right",this.context.textBaseline="bottom",this.context.fillText(`fps: ${t}`,this.viewPortWidth-20,30)});n(this,"detectPlatformCollision",()=>{const t=this.gameObjects.filter(i=>i instanceof Z||i instanceof vt),e=this.gameObjects.filter(i=>Rt(i)&&At(i));t.forEach(i=>{e.forEach(s=>{mt(i,s)&&(s.vCoordinates.y+s.getBottom()>i.vCoordinates.y+i.getBottom()&&s.vCoordinates.y+s.getTop()>i.vCoordinates.y+i.getTop()&&s.vCoordinates.x+s.getRight()>i.vCoordinates.x+i.getLeft()&&s.vCoordinates.x+s.getLeft()<i.vCoordinates.x+i.getRight()&&(s.vCoordinates.y=i.vCoordinates.y+i.getTop()-s.getBottom(),s.vVelocity.x=s.vVelocity.x*(1-s.friction),s.vVelocity.y=1,s.platform=i),s.vCoordinates.y+s.getTop()<i.vCoordinates.y+i.getTop()&&s.vCoordinates.y+s.getBottom()<i.vCoordinates.y+i.getBottom()&&s.vCoordinates.x+s.getRight()>i.vCoordinates.x+i.getLeft()&&s.vCoordinates.x+s.getLeft()<i.vCoordinates.x+i.getRight()&&(s.vCoordinates.y=i.vCoordinates.y-s.getTop(),s.vVelocity.y=-1),s.vCoordinates.x+s.getLeft()<i.vCoordinates.x+i.getLeft()&&s.vCoordinates.x+s.getRight()>i.vCoordinates.x+i.getLeft()&&s.vCoordinates.y+s.getTop()<i.vCoordinates.y+i.getTop()&&s.vCoordinates.y+s.getBottom()>=i.vCoordinates.y+i.getBottom()&&(s.vCoordinates.x=i.vCoordinates.x-s.getRight(),s.vVelocity.x=-1),s.vCoordinates.x+s.getLeft()<i.vCoordinates.x+i.getRight()&&s.vCoordinates.x+s.getRight()>i.vCoordinates.x+i.getRight()&&s.vCoordinates.y+s.getTop()<i.vCoordinates.y+i.getTop()&&s.vCoordinates.y+s.getBottom()>=i.vCoordinates.y+i.getBottom()&&(s.vCoordinates.x=i.vCoordinates.x+i.getRight(),s.vVelocity.x=1))})})});n(this,"spawnObject",t=>this.gameObjects.push(t));n(this,"despawnObject",t=>this.gameObjects=this.gameObjects.filter(({id:e})=>t.id!==e));n(this,"worldReset",()=>this.vViewCoordinates=new g);this.context=t,this.viewPortWidth=e.width,this.viewPortHeight=e.height}}const Ot=[{id:"santa",position:{x:1e3,y:300}}],zt=[{id:"base",type:"static",position:{x:0,y:-200},size:{width:300,height:300}},{id:"base",type:"static",position:{x:500,y:-200},size:{width:300,height:400}},{id:"base",type:"static",position:{x:900,y:-200},size:{width:300,height:500}},{id:"base",type:"static",position:{x:900,y:400},size:{width:300,height:250}},{id:"base",type:"static",position:{x:1500,y:-200},size:{width:100,height:525}},{id:"base",type:"static",position:{x:2e3,y:-200},size:{width:100,height:425}},{id:"base",type:"static",position:{x:2300,y:-200},size:{width:250,height:550}},{id:"base",type:"dynamic",position:{x:2600,y:200},size:{width:100,height:20},behavior:{target:{x:3e3,y:200},duation:10,repeat:"fromEnd",duration:10}},{id:"base",type:"dynamic",position:{x:3100,y:300},size:{width:100,height:20},behavior:{target:{x:3500,y:300},duation:10,repeat:"fromEnd",duration:10,shift:1}},{id:"base",type:"static",position:{x:3800,y:100},size:{width:300,height:100}},{id:"base",type:"static",position:{x:4200,y:200},size:{width:300,height:100}},{id:"base",type:"static",position:{x:4600,y:-200},size:{width:300,height:300}},{id:"base",type:"static",position:{x:5e3,y:-200},size:{width:200,height:400}}],ot={characters:Ot,platforms:zt},Vt="/new-year-game",$t=9.8;class Ft extends O{constructor(e,i){super(e,new g);n(this,"width");n(this,"height");n(this,"friction");n(this,"mass");n(this,"platform",null);n(this,"isColliding",!1);n(this,"sprite");n(this,"time",0);n(this,"column",0);n(this,"row",2);n(this,"horizontalMoveSpeed");n(this,"jumpImpulse");n(this,"isJumping",!1);n(this,"isMoveRight",!1);n(this,"isMoveLeft",!1);n(this,"draw",(e,i,s)=>{const r=this.vCoordinates.getViewCoordinates(i);this.isMoveRight?(this.column=Math.round(this.time*10%8),this.row=11):this.isMoveLeft?(this.column=Math.round(this.time*10%8),this.row=9):(this.row=2,this.column=0);const o=64,h=64;e.drawImage(this.sprite,this.column*o,this.row*h,o,h-2,r.x-s.x,r.y-this.height+s.y,this.width+o/4,this.height)});n(this,"update",(e,i)=>{this.checkEventListeners(),this.time+=e,this.vVelocity.y-=$t*this.mass*e,this.vVelocity.x=0,this.isMoveRight&&(this.vVelocity.x+=this.horizontalMoveSpeed),this.isMoveLeft&&(this.vVelocity.x-=this.horizontalMoveSpeed),this.platform&&(this.vVelocity.x+=this.platform.vVelocity.x),this.isJumping&&this.platform&&(this.platform=null,this.vVelocity.y=this.jumpImpulse),this.vCoordinates.x+=this.vVelocity.x*e,this.vCoordinates.y+=this.vVelocity.y*e,i.x=this.vCoordinates.x-250,i.y=this.vCoordinates.y-250});n(this,"checkEventListeners",()=>{this.eventListeners.forEach(e=>{e.check(this)&&(e.once&&this.removeEventListener(e.id),e.callback())})});n(this,"getTop",()=>this.height);n(this,"getBottom",()=>0);n(this,"getLeft",()=>0);n(this,"getRight",()=>this.width-16);n(this,"startJumping",()=>this.isJumping=!0);n(this,"stopJumping",()=>this.isJumping=!1);n(this,"startMoveRight",()=>this.isMoveRight=!0);n(this,"stopMoveRight",()=>this.isMoveRight=!1);n(this,"startMoveLeft",()=>this.isMoveLeft=!0);n(this,"stopMoveLeft",()=>this.isMoveLeft=!1);this.sprite=i,this.width=64,this.height=64,this.friction=.1,this.mass=100,this.horizontalMoveSpeed=500,this.jumpImpulse=500}}class Gt extends O{constructor(e,i,s){super(e,i);n(this,"width");n(this,"height");n(this,"isColliding",!1);n(this,"sprite");n(this,"draw",(e,i,s)=>{const r=this.vCoordinates.getViewCoordinates(i);this.isColliding&&(e.fillStyle="grey",e.fillRect(r.x-s.x,r.y-this.height,this.getRight(),this.height));const o=64,h=64;e.drawImage(this.sprite,o,2*h,o-o/4,h-2,r.x-s.x,r.y-this.height+s.y,this.width,this.height)});n(this,"update",()=>null);n(this,"getTop",()=>this.height);n(this,"getBottom",()=>0);n(this,"getLeft",()=>0);n(this,"getRight",()=>this.width);this.sprite=s,this.width=64,this.height=64}}class Nt extends O{constructor(e,i,s){super(e,new g);n(this,"width");n(this,"height");n(this,"textures");n(this,"draw",(e,i,s)=>{const r=this.vCoordinates.getViewCoordinates(i);let o=this.height,h=0;for(;o>0;){let l=this.width,d=0;for(;l>0;)e.drawImage(h===0?this.textures.head:this.textures.body,0,0,Math.min(128,l),Math.min(128,o),128*d+r.x-this.width/2,128*h+r.y-this.height+s.y,Math.min(128,l),Math.min(128,o)),l-=128,d++;o-=128,h++}});this.width=i.width,this.height=i.height,this.textures=s}}class qt extends O{constructor(e,i,s){super(e,new g);n(this,"width");n(this,"height");n(this,"texture");n(this,"draw",e=>{e.drawImage(this.texture,0,0,1920,1080,0,0,this.width,this.height);const i=e.createLinearGradient(0,100,0,0);i.addColorStop(0,"rgba(0, 0, 0, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=i,e.fillRect(0,this.height,this.width,-100),this.drawText(e),this.drawHelper(e)});n(this,"drawText",e=>{e.fillStyle="white",e.font="20px Arial",e.textAlign="center",e.textBaseline="bottom",e.fillText("\u041D\u0443\u0436\u043D\u043E \u043F\u043E\u043C\u043E\u0447\u044C \u0434\u0435\u0434\u0443 \u043C\u043E\u0440\u043E\u0437\u0443! \u041F\u043E\u0433\u043D\u0430\u043B\u0438 \u0432\u044B\u043F\u043E\u043B\u043D\u044F\u0442\u044C \u043A\u0432\u0435\u0441\u0442 :D",this.width/2,this.height-50)});n(this,"drawHelper",e=>{e.fillStyle="#ddd",e.font="15px Arial",e.textAlign="right",e.textBaseline="bottom",e.fillText("\u0414\u043B\u044F \u043F\u0440\u043E\u0434\u043E\u043B\u0436\u0435\u043D\u0438\u044F \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u043F\u0440\u043E\u0431\u0435\u043B",this.width-10,this.height-10)});this.width=i.width,this.height=i.height,this.texture=s}}class ft{constructor(){n(this,"assets",{});n(this,"get",async(t,e="png")=>this.assets[t]||await this.loadAsset(t,e));n(this,"loadAssets",async t=>{const e=await Promise.all(t.map(i=>this.loadAsset(i)));t.map((i,s)=>this.assets[i]=e[s])});n(this,"loadAsset",(t,e="png")=>new Promise(i=>{const s=new Image;s.src=`/new-year-game/assets/${t}.${e}`,s.onload=()=>i(s)}))}}class p{constructor(t,e){n(this,"id");n(this,"keys");n(this,"callback");this.id=Y(),this.keys=t,this.callback=e}}class X{constructor(){n(this,"events",{});n(this,"getHandler",t=>e=>{var i;(i=this.events[t])==null||i.filter(({keys:s})=>s.includes(e.code)).map(({callback:s})=>s())});n(this,"addEventListener",(t,e)=>{this.events[t]?this.events[t].push(e):(this.events[t]=[e],window.addEventListener(t,this.getHandler(t)))});n(this,"removeAllListeners",()=>{Object.keys(this.events).forEach(t=>window.removeEventListener(t,this.getHandler(t))),this.events={}});n(this,"removeEventListener",t=>{Object.keys(this.events).forEach(e=>{this.events[e]=this.events[e].filter(({id:i})=>t.id===i),this.events[e].length===0&&window.removeEventListener(e,this.getHandler(e))})})}}class Ht{constructor(){n(this,"sounds",{});n(this,"get",async(t,e="mp3")=>this.sounds[t]||await this.loadSound(t,e));n(this,"loadSounds",async t=>{const e=await Promise.all(t.map(i=>this.loadSound(i)));t.map((i,s)=>this.sounds[i]=e[s])});n(this,"loadSound",(t,e="mp3")=>new Promise(i=>{const s=new Audio(`${Vt}/assets/music/${t}.${e}`);s.preload="auto",s.controls=!1,s.loop=!0,s.volume=.05,s.onloadstart=()=>i(s)}))}}class Kt{constructor(t,e){n(this,"context");n(this,"viewPortSize");n(this,"gameDriver");n(this,"assetManager");n(this,"soundManager");n(this,"controlsManager");n(this,"controlsEvents",[]);n(this,"playerRespawn",new g(250,250));n(this,"currentSantaSpawn",0);n(this,"sound");n(this,"santaSpawnPositions",[new g(2400,350),new g(3800,200),new g(5100,200)]);n(this,"gameState",{isGameOver:!1,level:1});n(this,"gameStart",async()=>(this.gameDriver.backgroundImage=await this.assetManager.get("background/bg-game","jpg"),await this.spawnPlayer(),this.addSantaMeetingEventListener(),this.addGameOverEventListener(),this.startListeningControls(),this.gameDriver.start(),this.gameState));n(this,"loadMap",()=>Promise.all([Promise.all(ot.characters.map(({position:t})=>this.spawnSanta(t))),Promise.all(ot.platforms.map(({id:t,type:e,position:i,behavior:s,size:r})=>e==="static"?this.spawnPlatform(t,i,r):this.spawnMovingPlatform(t,i,s,r))),this.spawnWater()]));n(this,"spawnPlayer",async()=>{let t=[];this.gameState.player&&(this.stopListeningControls(),t=[...this.gameState.player.eventListeners],this.gameDriver.despawnObject(this.gameState.player)),this.gameState.player=new Ft(this.playerRespawn.getCopy(),await this.assetManager.get("characters/player")),this.gameState.player.eventListeners=t,this.gameDriver.spawnObject(this.gameState.player),this.initControlsListeners(),this.startListeningControls()});n(this,"spawnSanta",async t=>(this.gameState.santa&&this.gameDriver.despawnObject(this.gameState.santa),this.gameState.santa=new Gt(new g(t.x,t.y),new g,await this.assetManager.get("characters/santa")),this.gameDriver.spawnObject(this.gameState.santa),this.gameState.santa));n(this,"spawnWater",async()=>{const[t,e]=await Promise.all([this.assetManager.get("water/head"),this.assetManager.get("water/body")]),i=new Nt(new g(0,-400),{width:2*this.viewPortSize.width,height:400},{head:t,body:e});return this.gameDriver.spawnObject(i),i});n(this,"spawnOverlay",async()=>{this.gameState.overlay=this.gameDriver.overlay=new qt(new g(0,0),this.viewPortSize,await this.assetManager.get("dialog-overlay","jpg"))});n(this,"spawnPlatform",async(t,e,i)=>{const[s,r]=await Promise.all([this.assetManager.get(`platforms/${t}/head`),this.assetManager.get(`platforms/${t}/body`)]),o=new Z(e?new g().setByCoordsObject(e):new g,i||{width:0,height:0},{head:s,body:r});return this.gameDriver.spawnObject(o),o});n(this,"spawnMovingPlatform",async(t,e,i,s)=>{const[r,o]=await Promise.all([this.assetManager.get(`platforms/${t}/head`),this.assetManager.get(`platforms/${t}/body`)]),h=new vt(e?new g().setByCoordsObject(e):new g,i?{...i,vTarget:new g().setByCoordsObject(i.target)}:{vTarget:new g,duration:1,repeat:"none"},s||{width:0,height:0},{head:r,body:o});return this.gameDriver.spawnObject(h),h});n(this,"addGameOverEventListener",()=>{this.gameState.player&&this.gameState.player.addEventListener(new kt("less","y",0,!1,this.spawnPlayer))});n(this,"addSantaMeetingEventListener",()=>{this.gameState.player&&this.gameState.santa&&this.gameState.player.addEventListener(new Dt(this.gameState.santa,!0,this.spawnOverlay))});n(this,"startMiniGame",()=>{this.gameState.santa&&this.gameState.player&&this.gameDriver.overlay&&(delete this.gameState.overlay,this.gameDriver.overlay=null,this.playerRespawn=this.gameState.santa.vCoordinates.getCopy(),this.currentSantaSpawn<3&&(this.gameState.santa.vCoordinates=this.santaSpawnPositions[this.currentSantaSpawn++].getCopy(),this.addSantaMeetingEventListener()),this.stopListeningControls(),this.startMinigameCallback())});n(this,"startMinigameCallback",()=>{});n(this,"initControlsListeners",()=>{!this.gameState.player||(this.controlsEvents=[{action:"keydown",event:new p(["ArrowUp","KeyW"],this.gameState.player.startJumping)},{action:"keydown",event:new p(["ArrowRight","KeyD"],this.gameState.player.startMoveRight)},{action:"keydown",event:new p(["ArrowLeft","KeyA"],this.gameState.player.startMoveLeft)},{action:"keydown",event:new p(["Space"],this.startMiniGame)},{action:"keyup",event:new p(["ArrowUp","KeyW"],this.gameState.player.stopJumping)},{action:"keyup",event:new p(["ArrowRight","KeyD"],this.gameState.player.stopMoveRight)},{action:"keyup",event:new p(["ArrowLeft","KeyA"],this.gameState.player.stopMoveLeft)}])});n(this,"startListeningControls",()=>this.controlsEvents.map(({action:t,event:e})=>this.controlsManager.addEventListener(t,e)));n(this,"stopListeningControls",()=>this.controlsEvents.map(({event:t})=>this.controlsManager.removeEventListener(t)));this.context=t,this.viewPortSize=e,this.gameDriver=new It(t,e),this.controlsManager=new X,this.assetManager=new ft,this.soundManager=new Ht}}class Ut{constructor(t,e){n(this,"context");n(this,"grid",32);n(this,"level",[]);n(this,"colorMap",{R:"red",G:"green",B:"blue",Y:"yellow"});n(this,"controlsManager");n(this,"controlsEvents",[]);n(this,"colorsKeys",Object.keys(this.colorMap));n(this,"colors",Object.values(this.colorMap));n(this,"bubbleGap",1);n(this,"wallSize",4);n(this,"bubbles",[]);n(this,"particles",[]);n(this,"curBubblePos");n(this,"curBubble");n(this,"shootDeg",0);n(this,"minDeg");n(this,"maxDeg");n(this,"shootDir",0);n(this,"rAF",null);n(this,"endGameCallback");n(this,"size",{width:271,height:392});n(this,"degToRad",t=>t*Math.PI/180);n(this,"rotatePoint",(t,e,i)=>{const s=Math.sin(i),r=Math.cos(i);return{x:t*r-e*s,y:t*s+e*r}});n(this,"getRandomInt",(t,e)=>(t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t));n(this,"getDistance",(t,e)=>{const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)});n(this,"collides",(t,e)=>this.getDistance(t,e)<t.radius+e.radius);n(this,"getClosestBubble",(t,e=!1)=>{const i=this.bubbles.filter(s=>s.active==e&&this.collides(t,s));if(!!i.length)return i.map(s=>({distance:this.getDistance(t,s),bubble:s})).sort((s,r)=>s.distance-r.distance)[0].bubble});n(this,"createBubble",(t,e,i)=>{const s=Math.floor(e/this.grid),r=Math.floor(t/this.grid),o=s%2===0?0:.5*this.grid,h=this.grid/2;this.bubbles.push({x:this.wallSize+(this.grid+this.bubbleGap)*r+o+h,y:this.wallSize+(this.grid+this.bubbleGap-4)*s+h,radius:this.grid/2,color:i,active:!!i})});n(this,"getNeighbors",t=>{const e=[],i=[this.rotatePoint(this.grid,0,0),this.rotatePoint(this.grid,0,this.degToRad(60)),this.rotatePoint(this.grid,0,this.degToRad(120)),this.rotatePoint(this.grid,0,this.degToRad(180)),this.rotatePoint(this.grid,0,this.degToRad(240)),this.rotatePoint(this.grid,0,this.degToRad(300))];for(let s=0;s<i.length;s++){const r=i[s],o={x:t.x+r.x,y:t.y+r.y,radius:t.radius},h=this.getClosestBubble(o,!0);h&&h!==t&&!e.includes(h)&&e.push(h)}return e});n(this,"removeMatch",t=>{const e=[t];this.bubbles.forEach(s=>s.processed=!1),t.processed=!0;let i=this.getNeighbors(t);for(let s=0;s<i.length;s++){const r=i[s];r.processed||(r.processed=!0,r.color===t.color&&(e.push(r),i=i.concat(this.getNeighbors(r))))}e.length>=3&&e.forEach(s=>{s.active=!1})});n(this,"dropFloatingBubbles",()=>{const t=this.bubbles.filter(i=>i.active);t.forEach(i=>i.processed=!1);let e=t.filter(i=>i.y-this.grid<=this.wallSize);for(let i=0;i<e.length;i++){const s=e[i];s.processed||(s.processed=!0,e=e.concat(this.getNeighbors(s)))}t.filter(i=>!i.processed).forEach(i=>{i.active=!1,this.particles.push({x:i.x,y:i.y,color:i.color,radius:i.radius,active:!0})})});n(this,"getNewBubble",()=>{this.curBubble.x=this.curBubblePos.x,this.curBubble.y=this.curBubblePos.y,this.curBubble.dx=this.curBubble.dy=0;const t=this.bubbles.filter(i=>i.active&&i.color).map(({color:i})=>i).reduce((i,s)=>!s||i.includes(s)?i:[...i,s],[]),e=this.getRandomInt(0,t.length-1);this.curBubble.color=t[e],t.length===0&&(this.endGameCallback(),this.rAF&&window.cancelAnimationFrame(this.rAF))});n(this,"handleCollision",t=>{t.color=this.curBubble.color,t.active=!0,this.removeMatch(t),this.dropFloatingBubbles(),this.getNewBubble()});n(this,"loop",()=>{if(this.rAF=requestAnimationFrame(this.loop),this.context.clearRect(0,0,this.size.width,this.size.height),this.shootDeg+=this.degToRad(2)*this.shootDir,this.shootDeg<this.minDeg?this.shootDeg=this.minDeg:this.shootDeg>this.maxDeg&&(this.shootDeg=this.maxDeg),this.curBubble.x+=this.curBubble.dx,this.curBubble.y+=this.curBubble.dy,this.curBubble.x-this.grid/2<this.wallSize?(this.curBubble.x=this.wallSize+this.grid/2,this.curBubble.dx*=-1):this.curBubble.x+this.grid/2>this.size.width-this.wallSize&&(this.curBubble.x=this.size.width-this.wallSize-this.grid/2,this.curBubble.dx*=-1),this.curBubble.y-this.grid/2<this.wallSize){const t=this.getClosestBubble(this.curBubble);t&&this.handleCollision(t)}for(let t=0;t<this.bubbles.length;t++){const e=this.bubbles[t];if(e.active&&this.collides(this.curBubble,e)){const i=this.getClosestBubble(this.curBubble);i||(window.alert("Game Over"),window.location.reload()),i&&this.handleCollision(i)}}this.particles.forEach(t=>{t.y+=8}),this.particles=this.particles.filter(t=>t.y<this.size.height-this.grid/2),this.context.fillStyle="lightgrey",this.context.fillRect(0,0,this.size.width,this.wallSize),this.context.fillRect(0,0,this.wallSize,this.size.height),this.context.fillRect(this.size.width-this.wallSize,0,this.wallSize,this.size.height),this.bubbles.concat(this.particles).forEach(t=>{!t.active||(this.context.fillStyle=t.color||"black",this.context.beginPath(),this.context.arc(t.x,t.y,t.radius,0,2*Math.PI),this.context.fill())}),this.context.save(),this.context.translate(this.curBubblePos.x,this.curBubblePos.y),this.context.rotate(this.shootDeg),this.context.translate(0,-this.grid/2*4.5),this.context.strokeStyle="white",this.context.lineWidth=2,this.context.beginPath(),this.context.moveTo(0,0),this.context.lineTo(0,this.grid*2),this.context.moveTo(0,0),this.context.lineTo(-10,this.grid*.4),this.context.moveTo(0,0),this.context.lineTo(10,this.grid*.4),this.context.stroke(),this.context.restore(),this.context.fillStyle=this.curBubble.color,this.context.beginPath(),this.context.arc(this.curBubble.x,this.curBubble.y,this.curBubble.radius,0,2*Math.PI),this.context.fill()});n(this,"initControlsListeners",()=>{this.controlsEvents=[{action:"keydown",event:new p(["ArrowRight","KeyD"],this.handleMoveRight)},{action:"keydown",event:new p(["ArrowLeft","KeyA"],this.handleMoveLeft)},{action:"keydown",event:new p(["Space"],this.handleShoot)},{action:"keyup",event:new p(["KeyA","KeyD","ArrowLeft","ArrowRight"],this.handleMoveStop)}]});n(this,"startListeningControls",()=>this.controlsEvents.map(({action:t,event:e})=>this.controlsManager.addEventListener(t,e)));n(this,"stopListeningControls",()=>this.controlsEvents.map(({event:t})=>this.controlsManager.removeEventListener(t)));n(this,"handleShoot",()=>{this.curBubble.dx===0&&this.curBubble.dy===0&&(this.curBubble.dx=Math.sin(this.shootDeg)*this.curBubble.speed,this.curBubble.dy=-Math.cos(this.shootDeg)*this.curBubble.speed)});n(this,"handleMoveLeft",()=>this.shootDir=-1);n(this,"handleMoveRight",()=>this.shootDir=1);n(this,"handleMoveStop",()=>this.shootDir=0);this.context=t,this.controlsManager=new X,this.endGameCallback=e,this.initControlsListeners(),this.startListeningControls(),this.minDeg=this.degToRad(-60),this.maxDeg=this.degToRad(60),this.curBubblePos={x:this.size.width/2,y:this.size.height-this.grid*1.5},this.curBubble={x:this.curBubblePos.x,y:this.curBubblePos.y,color:"red",radius:this.grid/2,speed:8,dx:0,dy:0},this.prepareLevel(),window.requestAnimationFrame(this.loop)}prepareLevel(){var t;for(let e=0;e<5;e++){const i=e%2===0?8:7,s=[];for(let r=0;r<i;r++)s.push(this.colorsKeys[this.getRandomInt(0,this.colors.length-1)]);this.level.push(s)}for(let e=0;e<10;e++)for(let i=0;i<(e%2===0?8:7);i++){const s=(t=this.level[e])==null?void 0:t[i];this.createBubble(i*this.grid,e*this.grid,this.colorMap[s])}}}function Jt(a){let t;return{c(){t=y("canvas"),this.h()},l(e){t=x(e,"CANVAS",{width:!0,height:!0,id:!0}),B(t).forEach(v),this.h()},h(){u(t,"width","271"),u(t,"height","392"),u(t,"id","game")},m(e,i){S(e,t,i),a[1](t)},p:L,i:L,o:L,d(e){e&&v(t),a[1](null)}}}function Wt(a,t,e){const i=H();let s;K(()=>{const o=s.getContext("2d");o&&new Ut(o,()=>i("done"))});function r(o){U[o?"unshift":"push"](()=>{s=o,e(0,s)})}return[s,r]}class Yt extends T{constructor(t){super(),P(this,t,Wt,Jt,I,{})}}var q=(a=>(a.I="tetris/cube",a.O="tetris/cube-blue",a.T="tetris/cube-brown",a.S="tetris/cube-green",a.Z="tetris/cube-pink",a.J="tetris/cube-red",a.L="tetris/cube-violet",a))(q||{});class Zt{constructor(t,e){n(this,"context");n(this,"grid",32);n(this,"tetrominoSequence",[]);n(this,"playfield",[]);n(this,"assetManager");n(this,"loadedAssets",{});n(this,"controlsEvents",[]);n(this,"controlsManager");n(this,"count",0);n(this,"tetromino");n(this,"rAF",null);n(this,"gameOver",!1);n(this,"target",10);n(this,"score",0);n(this,"size",{width:320,height:640});n(this,"tetrominos",{I:[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],J:[[1,0,0],[1,1,1],[0,0,0]],L:[[0,0,1],[1,1,1],[0,0,0]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0],[0,0,0]],Z:[[1,1,0],[0,1,1],[0,0,0]],T:[[0,1,0],[1,1,1],[0,0,0]]});n(this,"endGameCallback");n(this,"init",async()=>{for(let t=-2;t<20;t++){this.playfield[t]=[];for(let e=0;e<10;e++)this.playfield[t][e]=null}await Promise.all(Object.keys(q).map(async t=>{this.loadedAssets[t]=await this.assetManager.get(q[t])})),this.rAF=requestAnimationFrame(this.loop)});n(this,"getRandomInt",(t,e)=>(t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t));n(this,"generateSequence",()=>{const t=["I","J","L","O","S","T","Z"];for(;t.length;){const e=this.getRandomInt(0,t.length-1),i=t.splice(e,1)[0];this.tetrominoSequence.push(i)}});n(this,"getNextTetromino",()=>{this.tetrominoSequence.length===0&&this.generateSequence();const t=this.tetrominoSequence.pop(),e=this.tetrominos[t],i=this.playfield[0].length/2-Math.ceil(e[0].length/2);return{name:t,matrix:e,row:t==="I"?-1:-2,col:i}});n(this,"rotate",t=>{const e=t.length-1;return t.map((s,r)=>s.map((o,h)=>t[e-h][r]))});n(this,"isValidMove",(t,e,i)=>{for(let s=0;s<t.length;s++)for(let r=0;r<t[s].length;r++)if(t[s][r]&&(i+r<0||i+r>=this.playfield[0].length||e+s>=this.playfield.length||this.playfield[e+s][i+r]))return!1;return!0});n(this,"placeTetromino",()=>{for(let t=0;t<this.tetromino.matrix.length;t++)for(let e=0;e<this.tetromino.matrix[t].length;e++)if(this.tetromino.matrix[t][e]){if(this.tetromino.row+t<0)return this.showGameOver();this.playfield[this.tetromino.row+t][this.tetromino.col+e]=this.tetromino.name}for(let t=this.playfield.length-1;t>=0;)if(this.playfield[t].every(e=>!!e)){for(let e=t;e>=0;e--)for(let i=0;i<this.playfield[e].length;i++)this.playfield[e][i]=this.playfield[e-1][i];this.score++,this.score>=this.target&&(this.endGameCallback(),this.rAF&&window.cancelAnimationFrame(this.rAF))}else t--;this.tetromino=this.getNextTetromino()});n(this,"loop",()=>{this.rAF=requestAnimationFrame(this.loop),this.context.clearRect(0,0,this.size.width,this.size.height);for(let t=0;t<20;t++)for(let e=0;e<10;e++)if(this.playfield[t][e]){const i=this.playfield[t][e];i&&this.context.drawImage(this.loadedAssets[i],e*this.grid,t*this.grid,this.grid-1,this.grid-1)}if(this.tetromino){++this.count>35&&(this.tetromino.row++,this.count=0,this.isValidMove(this.tetromino.matrix,this.tetromino.row,this.tetromino.col)||(this.tetromino.row--,this.placeTetromino()));for(let t=0;t<this.tetromino.matrix.length;t++)for(let e=0;e<this.tetromino.matrix[t].length;e++)this.tetromino.matrix[t][e]&&this.context.drawImage(this.loadedAssets[this.tetromino.name],(this.tetromino.col+e)*this.grid,(this.tetromino.row+t)*this.grid,this.grid-1,this.grid-1)}});n(this,"initControlsListeners",()=>{this.controlsEvents=[{action:"keydown",event:new p(["ArrowUp","KeyW"],this.handleRotate)},{action:"keydown",event:new p(["ArrowRight","KeyD"],this.handleMoveRight)},{action:"keydown",event:new p(["ArrowLeft","KeyA"],this.handleMoveLeft)},{action:"keydown",event:new p(["ArrowDown","KeyS"],this.handleMoveDown)}]});n(this,"startListeningControls",()=>this.controlsEvents.map(({action:t,event:e})=>this.controlsManager.addEventListener(t,e)));n(this,"stopListeningControls",()=>this.controlsEvents.map(({event:t})=>this.controlsManager.removeEventListener(t)));n(this,"handleMoveLeft",()=>{const t=this.tetromino.col-1;this.isValidMove(this.tetromino.matrix,this.tetromino.row,t)&&(this.tetromino.col=t)});n(this,"handleMoveRight",()=>{const t=this.tetromino.col+1;this.isValidMove(this.tetromino.matrix,this.tetromino.row,t)&&(this.tetromino.col=t)});n(this,"handleRotate",()=>{const t=this.rotate(this.tetromino.matrix);this.isValidMove(t,this.tetromino.row,this.tetromino.col)&&(this.tetromino.matrix=t)});n(this,"handleMoveDown",()=>{const t=this.tetromino.row+1;if(!this.isValidMove(this.tetromino.matrix,t,this.tetromino.col)){this.tetromino.row=t-1,this.placeTetromino();return}this.tetromino.row=t});this.context=t,this.assetManager=new ft,this.controlsManager=new X,this.endGameCallback=e,this.initControlsListeners(),this.startListeningControls(),this.init(),this.tetromino=this.getNextTetromino()}showGameOver(){this.rAF&&cancelAnimationFrame(this.rAF),this.gameOver=!0,this.context.fillStyle="black",this.context.globalAlpha=.75,this.context.fillRect(0,this.size.height/2-30,this.size.width,60),this.context.globalAlpha=1,this.context.fillStyle="white",this.context.font="36px monospace",this.context.textAlign="center",this.context.textBaseline="middle",this.context.fillText("GAME OVER!",this.size.width/2,this.size.height/2)}}function Xt(a){let t;return{c(){t=y("canvas"),this.h()},l(e){t=x(e,"CANVAS",{width:!0,height:!0,id:!0,class:!0}),B(t).forEach(v),this.h()},h(){u(t,"width","320"),u(t,"height","640"),u(t,"id","game"),u(t,"class","svelte-ny48w9")},m(e,i){S(e,t,i),a[1](t)},p:L,i:L,o:L,d(e){e&&v(t),a[1](null)}}}function Qt(a,t,e){const i=H();let s;K(()=>{const o=s.getContext("2d");o&&new Zt(o,()=>i("done"))});function r(o){U[o?"unshift":"push"](()=>{s=o,e(0,s)})}return[s,r]}class jt extends T{constructor(t){super(),P(this,t,Qt,Xt,I,{})}}function rt(a){let t,e;return{c(){t=y("h1"),e=J("\u0412\u044B \u043F\u043E\u0431\u0435\u0434\u0438\u043B\u0438! \u0421 \u041D\u043E\u0432\u044B\u043C \u0413\u043E\u0434\u043E\u043C!")},l(i){t=x(i,"H1",{});var s=B(t);e=W(s,"\u0412\u044B \u043F\u043E\u0431\u0435\u0434\u0438\u043B\u0438! \u0421 \u041D\u043E\u0432\u044B\u043C \u0413\u043E\u0434\u043E\u043C!"),s.forEach(v)},m(i,s){S(i,t,s),C(t,e)},d(i){i&&v(t)}}}function ht(a){let t,e,i,s,r,o,h;var l=a[4][a[3]];function d(c){return{}}return l&&(t=tt(l,d()),t.$on("done",a[5])),{c(){t&&F(t.$$.fragment),e=k(),i=y("button"),s=J("Skip minigame")},l(c){t&&gt(t.$$.fragment,c),e=R(c),i=x(c,"BUTTON",{});var m=B(i);s=W(m,"Skip minigame"),m.forEach(v)},m(c,m){t&&G(t,c,m),S(c,e,m),S(c,i,m),C(i,s),r=!0,o||(h=lt(i,"click",a[5]),o=!0)},p(c,m){if(l!==(l=c[4][c[3]])){if(t){ct();const _=t;A(_.$$.fragment,1,0,()=>{N(_,1)}),dt()}l?(t=tt(l,d()),t.$on("done",c[5]),F(t.$$.fragment),D(t.$$.fragment,1),G(t,e.parentNode,e)):t=null}},i(c){r||(t&&D(t.$$.fragment,c),r=!0)},o(c){t&&A(t.$$.fragment,c),r=!1},d(c){t&&N(t,c),c&&v(e),c&&v(i),o=!1,h()}}}function te(a){let t,e,i,s,r,o,h=a[2]&&rt(),l=!a[2]&&a[1]&&ht(a);return{c(){t=y("div"),h&&h.c(),e=k(),l&&l.c(),i=k(),s=y("canvas"),r=J("Your browser does not support the HTML5 canvas tag."),this.h()},l(d){t=x(d,"DIV",{class:!0});var c=B(t);h&&h.l(c),e=R(c),l&&l.l(c),i=R(c),s=x(c,"CANVAS",{width:!0,height:!0,class:!0});var m=B(s);r=W(m,"Your browser does not support the HTML5 canvas tag."),m.forEach(v),c.forEach(v),this.h()},h(){u(s,"width",1024),u(s,"height",512),u(s,"class","svelte-1rfllgf"),j(s,"display",a[1]||a[2]?"none":"block"),u(t,"class","container")},m(d,c){S(d,t,c),h&&h.m(t,null),C(t,e),l&&l.m(t,null),C(t,i),C(t,s),C(s,r),a[6](s),o=!0},p(d,[c]){d[2]?h||(h=rt(),h.c(),h.m(t,e)):h&&(h.d(1),h=null),!d[2]&&d[1]?l?(l.p(d,c),c&6&&D(l,1)):(l=ht(d),l.c(),D(l,1),l.m(t,i)):l&&(ct(),A(l,1,1,()=>{l=null}),dt()),c&6&&j(s,"display",d[1]||d[2]?"none":"block")},i(d){o||(D(l),o=!0)},o(d){A(l),o=!1},d(d){d&&v(t),h&&h.d(),l&&l.d(),a[6](null)}}}function ee(a,t,e){let i,s,r=!1,o=!1;const h=[Yt,St,jt];let l=0;K(async()=>{const m=s.getContext("2d");if(m){const _=s.getBoundingClientRect();i=new Kt(m,{width:_.width,height:_.height}),await i.loadMap(),i.gameStart(),i.startMinigameCallback=()=>{l<h.length?(e(1,r=!0),i.gameState.player&&(i.gameState.player.stopJumping(),i.gameState.player.stopMoveRight(),i.gameState.player.stopMoveLeft())):e(2,o=!0)}}});function d(){e(1,r=!1),e(3,l++,l),i.startListeningControls()}function c(m){U[m?"unshift":"push"](()=>{s=m,e(0,s)})}return[s,r,o,l,h,d,c]}class ie extends T{constructor(t){super(),P(this,t,ee,te,I,{})}}function se(a){let t,e,i,s,r;return s=new ie({}),{c(){t=y("meta"),e=k(),i=y("section"),F(s.$$.fragment),this.h()},l(o){const h=bt("svelte-t32ptj",document.head);t=x(h,"META",{name:!0,content:!0}),h.forEach(v),e=R(o),i=x(o,"SECTION",{class:!0});var l=B(i);gt(s.$$.fragment,l),l.forEach(v),this.h()},h(){document.title="Home",u(t,"name","description"),u(t,"content","Svelte demo app"),u(i,"class","svelte-iwe87e")},m(o,h){C(document.head,t),S(o,e,h),S(o,i,h),G(s,i,null),r=!0},p:L,i(o){r||(D(s.$$.fragment,o),r=!0)},o(o){A(s.$$.fragment,o),r=!1},d(o){v(t),o&&v(e),o&&v(i),N(s)}}}class oe extends T{constructor(t){super(),P(this,t,null,se,I,{})}}export{oe as default};
